 ServerName domain.com

    RewriteEngine On
    RewriteCond %{HTTPS} !=on
    RewriteRule ^/?(.*) https://%{SERVER_NAME}/$1 [R,L]
</VirtualHost>

# Main HTTPS VirtualHost
<VirtualHost *:443>
    ServerName domain.com

    DocumentRoot /var/www/html

    # Proxy frontend: /beta --> http://10.10.10.10:3001
    ProxyPass /beta http://10.10.10.10:3001
    ProxyPassReverse /beta http://10.10.10.10:3001

    # API: preserve /api-beta in path
    ProxyPass /api-beta/ http://10.10.10.10:3000/api-beta/
    ProxyPassReverse /api-beta/ http://10.10.10.10:3000/api-beta/

    # ✅ FIXED: Kafka proxy — must match Kafdrop's internal context path!
    ProxyPass /kafka/ http://10.10.10.10:9000/kafka/
    ProxyPassReverse /kafka/ http://10.10.10.10:9000/kafka/



    <Directory /var/www/html>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    SSLEngine on
    SSLCertificateFile /root/certs/fullchain.crt
    SSLCertificateKeyFile /root/certs/privkey.pem

    SSLProtocol -all +TLSv1.2 +TLSv1.3
    SSLHonorCipherOrder On
    SSLCipherSuite HIGH:!aNULL:!MD5
</VirtualHost>
